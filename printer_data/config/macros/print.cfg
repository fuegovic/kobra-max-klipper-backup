macros/
├── print.cfg           # START_PRINT, END_PRINT, PAUSE_PRINT, CANCEL_PRINT
├── filament.cfg        # LOAD_FILAMENT, UNLOAD_FILAMENT, CHANGE_FILAMENT
├── calibration.cfg     # CLEAR_MESH, CALIBRATE_PROBE, QUICK_COLD_MESH, HOT_MESH, SMART_MESH (legacy)
├── tuning.cfg          # TEST_FANS, TEST_SPEED, PA_TUNING_TOWER, RESONANCE_TEST, INPUT_SHAPER_SAVE
├── utils.cfg           # HOME, LED_ON, LED_OFF, SAFE_POWER_OFF, QUICK_POWER_OFF, PROBE_RESET
│                       # M300, BEEP_SHORT/LONG/DOUBLE/ALERT, SNAPSHOT, STATUS_REPORT, SAVE_AND_RESTART

#/#/#/#/#/#/#/#/#/#/#/#/#/#/#/#/#/#/#/#/#/#/#/#/#/#/#/#/#/#/#/#/#/#/
####################################################################
### print.cfg: START_PRINT, END_PRINT, PAUSE_PRINT, CANCEL_PRINT ###
####################################################################
#/#/#/#/#/#/#/#/#/#/#/#/#/#/#/#/#/#/#/#/#/#/#/#/#/#/#/#/#/#/#/#/#/#/

####################################################################
# Start Print
####################################################################
[gcode_macro START_PRINT]
description: Prepare printer, heat bed/nozzle, home, load mesh, purge line, and begin print
gcode:
    M117 Getting ready
    # Parameters:
    #   EXTRUDER_TEMP: nozzle temp (default 190)
    #   BED_TEMP: bed temp (default 60)
    #   PAUSE: pause after mesh (default false)
    {% set EXTRUDER_TEMP = params.EXTRUDER_TEMP|default(190)|float %}
    {% set BED_TEMP = params.BED_TEMP|default(60)|float %}
    {% set pause_after_mesh = params.PAUSE|default(False) %}
    
    M117 Heating bed and nozzle
    M140 S{BED_TEMP}                 ; start heating bed
    M104 S{EXTRUDER_TEMP}            ; start heating nozzle
    
    M117 Lights on
    LED_ON
    
    M117 Homing...
    G28                              ; home all axes
    M400
    SMART_PARK
    
    M117 Wait for bed and nozzle
    M190 S{BED_TEMP}                 ; wait for bed
    M109 S{EXTRUDER_TEMP}            ; wait for nozzle
    
    M117 Adaptive Meshing (mesh the print area)
    EXCLUDE_OBJECT_DEFINE
    BED_MESH_CALIBRATE
    {% if pause_after_mesh %}
      M117 Paused after mesh — resume when ready
      PAUSE
    {% endif %}
    
    M117 Adaptive Purging (purge next to the print area)    
    LINE_PURGE
    G92 E0                           ; reset extruder after purge
    
    M117 Starting in 3...2...1...
    SMART_PARK
    G90                              ; restore absolute positioning
    M400
    BEEP_SHORT
    M117 Print Started! 

####################################################################
# END PRINT
####################################################################
[gcode_macro END_PRINT]
description: Safely finish print — retract, lift nozzle, cool heaters, park, then power off
gcode:
    # Parameters:
    #   RAISE_MM: nozzle lift height above current Z (default 20)
    #   PAUSE_BEFORE_POWER_OFF: pause before shutdown (default false)

    {% set RAISE_MM = 20 %}
    {% set PARK_X = printer.toolhead.axis_maximum.x|float - 5 %}
    {% set PARK_Y = printer.toolhead.axis_maximum.y|float - 5 %}

    M117 END_PRINT: starting shutdown sequence
    RESPOND TYPE=command MSG="END_PRINT: starting shutdown sequence"

    # Begin cooldown
    M117 END_PRINT: cooling heaters and fan
    M140 S0
    M104 S0
    M106 S0
    M117 Print complete

    # Retract filament slightly to relieve pressure
    M117 END_PRINT: retracting filament
    G91
    G1 E-3 F2400
    G90

    # Raise nozzle to avoid collision with print
    M117 END_PRINT: lifting nozzle by {RAISE_MM}mm
    G91
    G1 Z{RAISE_MM} F1000
    G90

    # Wait for motion to settle and temps to drop
    M117 END_PRINT: settling motion and cooling
    M400
    G4 P2000

    # Move to park position near front-right corner
    M117 END_PRINT: parking head at X{PARK_X} Y{PARK_Y}
    G0 X{PARK_X} Y{PARK_Y} F6000
    M400
    G4 P500

    # Visual and audio confirmation
    M117 END_PRINT: shutting down
    LED_OFF
    BEEP_LONG
    M117 Print Completed!

    # Optional pause before power off
    {% if params.PAUSE_BEFORE_POWER_OFF|default(False) %}
      M117 Paused before power off — resume when ready
      PAUSE
    {% endif %}

    M117 END_PRINT: calling POWER_OFF
    RESPOND TYPE=command MSG="END_PRINT: calling POWER_OFF"

    # Final power-off sequence
    POWER_OFF


####################################################################
# Pause with audible alert
####################################################################
[gcode_macro PAUSE]
rename_existing: BASE_PAUSE
description: Pause print and play alert beeps
gcode:
    BASE_PAUSE
    # Optional: park head safely
    G91
    G1 Z10 F600          ; lift nozzle 10mm
    G90
    G1 X10 Y10 F6000     ; move to front-left (adjust as desired)
    # Audible alert
    BEEP_ALERT

####################################################################
# Cancel print with error beep
####################################################################
[gcode_macro CANCEL_PRINT]
rename_existing: BASE_CANCEL_PRINT
description: Cancel print and play error beeps
gcode:
    BASE_CANCEL_PRINT
    # Optional: move bed forward for access
    G91
    G1 Z10 F600
    G90
    G1 X0 Y200 F6000     ; adjust to your printer’s safe park
    # Audible error alert
    BEEP_ERROR